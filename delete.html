<!DOCTYPE HTML>
<html>
	<header>
		<style>
			body {
				margin: 0px;
				padding: 0px;
			}
			.centered {
  				position: fixed;
  				top: 50%;
  				left: 50%;
  				transform: translate(-50%, -50%);
			}
			#myCanvas {
				border: 3;
				border-style: solid;
				border-color: rgb(0,0,0);
				margin: auto 0;	
			}
		</style>
		<noscript style="font-size:75px;">Sorry, your browser does not support JavaScript!</noscript>
	</header>
	<body>			
		<h1 style="margin:0; padding:0;color:green;margin-left:4em;">PONG programmed by Derrick Douglass <a href="http:\\www.derrickdouglassdesigns.com">www.derrickdouglassdesigns.com</a>:: BETA VERSION</h1>
		<div class='container centered'>
			<form style="margin-top:5px;"><input type="button" value="serve" onclick="serveBall();" /></form>
			<br />
			<canvas id="myCanvas" width="1500%" height="675%" style="background-color: #000;" tabindex='1'></canvas>
				<!--This section plays the MorseCode audio file-->
			<audio class="hit">
				<source src="18790.wav">
				<p>Your browser does not support the audio element.</p>
			</audio>
			<audio class="score">
				<source src="score.mp3">
				<p>Your browser does not support the audio element.</p>
			</audio>
		</div>
		<script>
			var canvas = document.getElementById('myCanvas');
			// var source_v = document.createElement('source');
			// var source_z = document.createElement('source');

			// source_v.src = "18790.wav";
			// source_z.src = "score.mp3";

			var v = document.getElementsByClassName("hit")[0];
			var z = document.getElementsByClassName("score")[0];

			// v.appendChild(source_v);
			// z.appendChild(source_z);

			var xCoordsBall = canvas.width/2;
			var yCoordsBall = canvas.height/2;

			var xCoordsRaquetLeft = canvas.width/14;
			var yCoordsRaquetLeft = canvas.height/2 - 90;

			var xCoordsRaquetRight = canvas.width/1.1;
			var yCoordsRaquetRight = canvas.height/2  - 30;

			var context = canvas.getContext('2d');
			var radius = 6;


			var rightScore = new Score(context, 'right'); 
			var leftScore = new Score(context, 1);

			var leftRaquet = new Raquet(context, canvas);
			var rightRaquet = new Raquet(context, canvas); 
						
			var gameBall = new Ball(context, canvas, leftScore);

			rightRaquet.drawInitialRaquet(context, canvas, canvas.width/1.1, canvas.height/2  - 30, 'right');
			leftRaquet.drawInitialRaquet(context, canvas, canvas.width/14, canvas.height/2 - 90, 'left');

			leftScore.updateScore();

			var map = {38: false, 81: false, 40: false, 90: false};

			//This block handles each raquets controls
		          document.addEventListener('keydown', function(event) {
	        			 if (event.keyCode in map) {
        			      	map[event.keyCode] = true;
        			      		//up arrow keydown
	        			      	if (map[38]) {
						rightRaquet.moveRaquet('up');
				      	}
				      	//letter q keydown
	        			      	if (map[81] && yCoordsRaquetLeft >= -1) {
	        			      		leftRaquet.moveRaquet('up');
					}
					//up arrow && letter q keydown
					if (map[38] && map[81]) {
	        			      		if (yCoordsRaquetRight >= -1) {
							clearRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetRight = yCoordsRaquetRight - 10;
						          drawRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
					      	}
					          if (yCoordsRaquetLeft >= -1 ) {
							clearRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetLeft = yCoordsRaquetLeft - 10;
						          drawRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
						}
				      	}
				      	//down arrow keydown
		      		        	if (map[40]) {
	        			      		rightRaquet.moveRaquet('down');
				      	}
				      	//letter z keydown
	        			      	if (map[90] &&  ((yCoordsRaquetLeft+60) <= canvas.height)) {
						leftRaquet.moveRaquet('down');
					}
					//down arrow && letter z keydown
					if (map[40] && map[90]) {
	        			      		if ((yCoordsRaquetRight+60) <= canvas.height) {
			      			     	// console.log(yCoordsRaquetRight);
							clearRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetRight = yCoordsRaquetRight + 10;
						          drawRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
					      	}
					          if ((yCoordsRaquetLeft+60) <= canvas.height) {
			      			     	// console.log(yCoordsRaquetLeft);
							clearRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetLeft = yCoordsRaquetLeft + 10;
						          drawRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
						}
				      	}
	      			}
			}, false);
			document.addEventListener('keyup', function(event) {
				if (event.keyCode in map) {
				        map[event.keyCode] = false;
				    }
				}, false);

			function serveBall(){	
			leftScore.drawScore(context);
			leftRaquet.clearRaquet();
			rightRaquet.clearRaquet();
			leftRaquet.drawInitialRaquet(context, canvas, canvas.width/14, canvas.height/2 - 90);
			rightRaquet.drawInitialRaquet(context, canvas, canvas.width/1.1, canvas.height/2  - 30);	
			gameBall.drawInitialBall(context, canvas, canvas.width/2, canvas.height/2);
			gameBall.moveBall(2, Math.random(), leftRaquet, rightRaquet);
			}
			//End servBall
			function Score(context, player) {

				var self = this;
				var _context = context;
				var tempArray = [];
				var _currentScore = 0;
				var _player = player;
				var left;
				var right;

				var Top = [351,50,362,60,386,60,398,50,351,50];
				var TopRight = [399,50,399,82,393,88,388,83,388,60];
				var BottomRight = [399,95,399,126,388,116,388,94,393,89];
				var Middle = [392,88,387,93,362,93,357,88,362,83,387,83];
				var Bottom = [387,116,398,127,351,127,362,116];
				var BottomLeft = [356,89,361,94,361,116,351,125,351,93];
				var TopLeft = [351,51,361,61,361,61,361,83,356,88,351,83];

				// var Top = [416,50,427,60,451,60,463,50,416,50];
				// var TopRight = [464,50,464,82,458,88,453,83,453,60];
				// var BottomRight = [464,95,464,126,453,116,453,94,458,89];
				// var Middle = [457,88,452,93,427,93,422,88,427,83,452,83];
				// var Bottom = [452,116,463,127,416,127,427,116];
				// var BottomLeft = [421,89,426,94,426,116,416,125,416,93];
				// var TopLeft = [416,51,426,61,426,61,426,83,421,88,416,83];

				this.getScore = function() {

					return _currentScore;
					return;

				}

				this.incrementScore = function() {

					_currentScore++;
					return;
				}

				this.updateScore = function() {

					if (_player == '1') {
						left = 0;
						right = 65;
					}
					else {
						left = 200;
						right = 265;	
					}

					switch (_currentScore) {
						case 0:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 1: 
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [TopRight, BottomRight];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 2: 
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, Middle, BottomLeft, Bottom];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 3: 
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, BottomRight, Middle, Bottom];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 4:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [TopRight, BottomRight, Middle, TopLeft];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 5:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopLeft, Middle, BottomRight, Bottom];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 6:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, BottomRight, Middle, Bottom, BottomLeft, TopLeft];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 7:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, BottomRight];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 8:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, BottomRight, Middle, Bottom, BottomLeft, TopLeft];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 9:
							self.clearScore();
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, Middle, BottomRight, TopLeft];
							self.drawScore(right);
							self.incrementScore();
						break;
						case 10:
							self.clearScore();
							scoreCoordArray = scoreCoordArray = [TopRight, BottomRight];
							self.drawScore(left);
							scoreCoordArray = [Top, TopRight, BottomRight,  Bottom, BottomLeft, TopLeft];
							self.drawScore(right);
							self.incrementScore();
						break;


					}
					return;
				}

	      			this.clearScore = function() {

					if (_player == '1') {
						_context.clearRect(416, 50, 48, 80);
						_context.clearRect(351, 50, 48, 80);
					}
					else _context.clearRect(0, 0, 0, 0);
				           return;
				}	

				this.drawScore = function (position) {

			
					//The outer loop moves each array in the multi-dimensional scoreCoordArray into the tempArray
					for (var index = 0; index < scoreCoordArray.length; index++) {


						tempArray = scoreCoordArray[index];

						_context.beginPath();

						//The inner loop takes each tempArray elements and 
						for (var counter = 0; counter < tempArray.length - 1; counter += 2) {

							if (counter == 0 || counter == 1 ) {

							nextVal = counter + 1;

							_context.moveTo(tempArray[counter] + position, tempArray[nextVal]);	
							}
							else {
							nextVal = counter + 1;
							_context.lineTo(tempArray[counter]  + position, tempArray[nextVal]);

							}

						}
						_context.closePath();
						_context.fillStyle = "#FFFFFF";
						_context.fill();
					}
				}
				return;
			}
			//End Score

 			function Ball(context, canvas, leftScore) {

				var self = this;
				var _context;
				var _canvas; 
				var _xCoordsBall; 
				var _yCoordsBall;
				var direction = 'left'; 

				Ball.prototype.drawInitialBall = function(context, canvas, xCoordsBall, yCoordsBall) {

					_context = context;
					_canvas = canvas;
					_xCoordsBall = xCoordsBall;
					_yCoordsBall = yCoordsBall;
				 
				          self.drawBall();
				}

				Ball.prototype.drawBall = function () {
				           _context.beginPath();
				           _context.arc(_xCoordsBall, _yCoordsBall, radius, 0, 2 * Math.PI, false);
				           _context.fillStyle = 'rgb(255,255,255)';
				           _context.fill();
				           return;
				}

	 			Ball.prototype.clearBall = function () {
				           _context.beginPath();
				           _context.arc(_xCoordsBall, _yCoordsBall, radius + 4, 0, 2 * Math.PI, false);
				           _context.fillStyle = 'rgb(0,0,0)';
				           _context.fill();
				           return;
			           }

       				Ball.prototype.moveBall = function(angleX, angleY, leftRaquet, rightRaquet) {
           					
					var endInterval = setInterval(function(){
						self.clearBall();
					          //Bounce ball off top of Canvas by making angle of Y axis positive
						if (_yCoordsBall < 0 && direction == 'right') { 
							angleY = Math.abs(angleY);
						}
						//Bounce ball off bottom of Canvas by making angle of Y axis negative
						if (_yCoordsBall > _canvas.height && direction == 'right') { 
							angleY = -Math.abs(angleY);
						}
						if (_yCoordsBall < 0 && direction == 'left') { 
							angleY = -Math.abs(angleY);
						}
						//Bounce ball off bottom of Canvas by making angle of Y axis negative
						if (_yCoordsBall > _canvas.height && direction == 'left') { 
							angleY = Math.abs(angleY);
						}

					          if(direction == 'left') {
						           _xCoordsBall = _xCoordsBall - angleX;
							_yCoordsBall = _yCoordsBall - angleY;

						          	if (_xCoordsBall >= 45) {
							          self.drawBall();

		          					          if (_xCoordsBall == 126) {

			        					          if (leftRaquet.yCoords() <= _yCoordsBall - 3 && (leftRaquet.yCoords() + 8.57) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(2,-.35, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 8.57) < _yCoordsBall && (leftRaquet.yCoords() + 17.14) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(2,-.5, leftRaquet, rightRaquet);
								          	}
					        					if ((leftRaquet.yCoords() + 17.14) < _yCoordsBall && (leftRaquet.yCoords() + 25.71) >= _yCoordsBall) {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(2,-.75, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 25.71) < _yCoordsBall && (leftRaquet.yCoords() + 34.28) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(1,.9, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 34.28) < _yCoordsBall && (leftRaquet.yCoords() + 42.8) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(1,1.3, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 42.8) < _yCoordsBall && (leftRaquet.yCoords() + 51.52) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(1,1.7, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 51.52) < _yCoordsBall && (leftRaquet.yCoords() + 63) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'right';	
									          	self.moveBall(.9,2, leftRaquet, rightRaquet);
								          	}
							          }
						          }
						           else {
						           	self.clearBall();
						           	z.play();
						           	if(leftScore.getScore() < 10) {
						           		leftScore.updateScore(1);
					           		} 
						           	else {
						           		leftScore.updateScore(1);
						           		alert ('game over: Right Player Wins!!!!!!!');
					           		} 
							          clearInterval(endInterval);

						          }
						}
						if(direction == 'right') {
							self.drawBall();
						       	_xCoordsBall = _xCoordsBall + angleX;
							_yCoordsBall = _yCoordsBall + angleY;
						          	if (_xCoordsBall <=(canvas.width-45)) {
						          		self.drawBall();

							          if (_xCoordsBall >= 1348 && _xCoordsBall <= 1349){

								          if (rightRaquet.yCoords() <= (_yCoordsBall - 3) && (rightRaquet.yCoords() + 8.57) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(2,-.35, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 8.57) < _yCoordsBall && (rightRaquet.yCoords() + 17.14) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(2,-.5, leftRaquet, rightRaquet);
								          	}
									if ((rightRaquet.yCoords() + 17.14) < _yCoordsBall && (rightRaquet.yCoords() + 25.71) >= _yCoordsBall) {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(2,-.75, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 25.71) < _yCoordsBall && (rightRaquet.yCoords() + 34.28) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(1,.9, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 34.28) < _yCoordsBall && (rightRaquet.yCoords() + 42.8) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(1,1.3, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 42.8) < _yCoordsBall && (rightRaquet.yCoords() + 51.52) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(1,1.7, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 51.52) < _yCoordsBall && (rightRaquet.yCoords() + 63) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
										v.play();
										direction = 'left';	
									          	self.moveBall(.9,2, leftRaquet, rightRaquet);
								          	}
							          }
						          }
						          else {
							          self.clearBall();
							          z.play();
							          clearInterval(endInterval);
						          }
					      	}

					}, 3);

				}
			}
			//End Ball
			function Raquet(context, canvas) {

				this._context = 0;
				var _canvas;
				// var this._xCoordsRaquet;
				// var this._yCoordsRaquet;

				this.yCoords = function(){
					return this._yCoordsRaquet;
				}
				this.xCoords = function(){
					return this._xCoordsRaquet;
				}

				Raquet.prototype.drawInitialRaquet = function(context, canvas, xCoordsRaquet, yCoordsRaquet, player) {
					
					_context = context;
					this._canvas = canvas;
					this._xCoordsRaquet = xCoordsRaquet;
					this._yCoordsRaquet = yCoordsRaquet;
				 
				            this.drawRaquet(); 
				}

				Raquet.prototype.drawRaquet = function() {
				          context.beginPath();
				          context.rect(this._xCoordsRaquet, this._yCoordsRaquet, 10, 60);
				          context.fillStyle = 'rgb(255,255,255)';
				          context.fill();
				          return;
				}

	      			Raquet.prototype.clearRaquet = function() {
					context.clearRect(this._xCoordsRaquet-2, this._yCoordsRaquet-4, 11, 60);
					context.beginPath();
				            context.rect(this._xCoordsRaquet-2, this._yCoordsRaquet-4, 15, 66);
				            context.fillStyle = 'rgb(0,0,0)';
				            context.fill();
				           return;
				}

				Raquet.prototype.moveRaquet = function(direction) {
					if (this._yCoordsRaquet >= -1 && direction == 'up' ) {
						this.clearRaquet();
				            	this._yCoordsRaquet -= 10;
				            	this.drawRaquet();
					}
					if ((this._yCoordsRaquet+60) <= this._canvas.height && direction == 'down' ) {
						this.clearRaquet();
				            	this._yCoordsRaquet += 10;
				            	this.drawRaquet();
				          }
				}
			}
			//End Raquet

		</script>
	</body>
</html>