<!DOCTYPE HTML>
<html>
	<header>
		<style>
			body {
				margin: 0px;
				padding: 0px;
			}
			.centered {
  				position: fixed;
  				top: 50%;
  				left: 50%;
  				transform: translate(-50%, -50%);
			}
			#myCanvas {
				border: 3;
				border-style: solid;
				border-color: rgb(0,0,0);
				margin: auto 0;	
			}
		</style>
	</header>
	<body>			
		<h1 style="margin:0; padding:0;color:green;">PONG programmed by Derrick Douglass <a href="http:\\www.derrickdouglassdesigns.com">www.derrickdouglassdesigns.com</a>:: BETA VERSION</h1>
		<div class='container centered'>

			<canvas id="myCanvas" width="1500%" height="675%" style="background-color: #000;" tabindex='1'></canvas>
				<!--This section plays the MorseCode audio file-->
			<audio>
				<source src="18790.wav">
				<p>Your browser does not support the audio element.</p>
			</audio>
		</div>
		<script>
			var canvas = document.getElementById('myCanvas');
			var v = document.getElementsByTagName("audio")[0];

			var xCoordsBall = canvas.width/2;
			var yCoordsBall = canvas.height/2;

			var xCoordsRaquetLeft = canvas.width/14;
			var yCoordsRaquetLeft = canvas.height/2 - 90;

			var xCoordsRaquetRight = canvas.width/1.1;
			var yCoordsRaquetRight = canvas.height/2  - 30;

			var context = canvas.getContext('2d');
			var radius = 6;

			var leftRaquet = new Raquet(context, canvas); 
			var rightRaquet = new Raquet(context, canvas); 
			var gameBall = new Ball(context, canvas); 

			gameBall.drawInitialBall(context, canvas, canvas.width/2, canvas.height/2);
			// console.log(context, canvas, canvas.width/2, canvas.height/2);
			gameBall.moveBall(2, Math.random(), leftRaquet, rightRaquet);

			leftRaquet.drawInitialRaquet(context, canvas, canvas.width/14, canvas.height/2 - 90);
			rightRaquet.drawInitialRaquet(context, canvas, canvas.width/1.1, canvas.height/2  - 30);



			var map = {38: false, 81: false, 40: false, 90: false};

			//This block handles each raquets controls
		          document.addEventListener('keydown', function(event) {
	        			 if (event.keyCode in map) {
        			      	map[event.keyCode] = true;
        			      		//up arrow keydown
	        			      	if (map[38]) {
						rightRaquet.moveRaquet('up');
				      	}
				      	//letter q keydown
	        			      	if (map[81] && yCoordsRaquetLeft >= -1) {
	        			      		leftRaquet.moveRaquet('up');
					}
					//up arrow && letter q keydown
					if (map[38] && map[81]) {
	        			      		if (yCoordsRaquetRight >= -1) {
			      			     	// console.log(yCoordsRaquetRight);
							clearRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetRight = yCoordsRaquetRight - 10;
						          drawRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
					      	}
					          if (yCoordsRaquetLeft >= -1 ) {
			      			     	// console.log(yCoordsRaquetLeft);
							clearRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetLeft = yCoordsRaquetLeft - 10;
						          drawRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
						}
				      	}
				      	//down arrow keydown
		      		        	if (map[40]) {
	        			      		rightRaquet.moveRaquet('down');
				      	}
				      	//letter z keydown
	        			      	if (map[90] &&  ((yCoordsRaquetLeft+60) <= canvas.height)) {
						leftRaquet.moveRaquet('down');
					}
					//down arrow && letter z keydown
					if (map[40] && map[90]) {
	        			      		if ((yCoordsRaquetRight+60) <= canvas.height) {
			      			     	// console.log(yCoordsRaquetRight);
							clearRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetRight = yCoordsRaquetRight + 10;
						          drawRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);
					      	}
					          if ((yCoordsRaquetLeft+60) <= canvas.height) {
			      			     	// console.log(yCoordsRaquetLeft);
							clearRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
							context.setTransform(1,0,0,1,0,0);
							yCoordsRaquetLeft = yCoordsRaquetLeft + 10;
						          drawRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
						}
				      	}
	      			}
			}, false);
			document.addEventListener('keyup', function(event) {
				if (event.keyCode in map) {
				        map[event.keyCode] = false;
				    }
				}, false);

			function initGame() {
				var xCoordsBall = canvas.width/2;
				var yCoordsBall = canvas.height/2;

			var xCoordsRaquetLeft = canvas.width/14;
			var yCoordsRaquetLeft = canvas.height/2 - 30;

			var xCoordsRaquetRight = canvas.width/1.1;
			var yCoordsRaquetRight = canvas.height/2  - 30;

				context.clearRect(0, 0, canvas.width, canvas.height);


				drawBall(context, xCoordsBall, yCoordsBall);
				drawRaquet(context, xCoordsRaquetLeft, yCoordsRaquetLeft);
				drawRaquet(context, xCoordsRaquetRight, yCoordsRaquetRight);

				sendBallLeft(2,Math.random());
			}

			function sendBallRight(angleX, angleY){

				var endInterval = setInterval(function(){
				      	// console.log(xCoordsRaquetRight);
					clearBall(context);
					context.setTransform(1,0,0,1,0,0);
					//Bounce ball off top of Canvas by making angle of Y axis positive
					if (yCoordsBall < 0) { 
						angleY = Math.abs(angleY);
					}
					//Bounce ball off bottom of Canvas by making angle of Y axis negative
					if (yCoordsBall > canvas.height) { 
						angleY = -Math.abs(angleY);
					}
					xCoordsBall = xCoordsBall + angleX;
					yCoordsBall = yCoordsBall + angleY;
					
				          if (xCoordsBall <=(canvas.width-45)) {
					          	drawBall(context, xCoordsBall, yCoordsBall);
					          	// console.log(xCoordsBall, yCoordsRaquetRight, yCoordsBall);
        					          if (xCoordsBall >= 1348 && xCoordsBall <= 1349){

	        					              if (yCoordsRaquetRight <= yCoordsBall-3 && (yCoordsRaquetRight + 90) >= yCoordsBall)  {
							          	// alert('8.57');
							          	clearInterval(endInterval);
									v.play();	
							          	sendBallLeft(2,-.35);
						          	}
						 if ((yCoordsRaquetRight + 8.57) < yCoordsBall && (yCoordsRaquetRight + 17.14) >= yCoordsBall)  {
							clearInterval(endInterval);
							v.play();	
							sendBallLeft(2,-.5);
						 }
		     //    					if ((yCoordsRaquetRight + 17.14) < yCoordsBall && (yCoordsRaquetRight + 25.71) >= yCoordsBall) {
		     //    						// alert('25.71'); 
							//           	clearInterval(endInterval);
							// 	v.play();	
							//           	sendBallLeft(0,0);
						 //          	}
						 //          	if ((yCoordsRaquetRight + 25.71) < yCoordsBall && (yCoordsRaquetRight + 34.28) >= yCoordsBall)  {
						 //          		// alert('34.28');
							//           	clearInterval(endInterval);
							// 	v.play();	
							//           	sendBallLeft(1,.9);
						 //          	}
						 //          	if ((yCoordsRaquetRight + 34.28) < yCoordsBall && (yCoordsRaquetRight + 42.8) >= yCoordsBall)  {
						 //          		// alert('42.8');
							//           	clearInterval(endInterval);
							// 	v.play();	
							//           	sendBallLeft(1,1.3);
						 //          	}
						 //          	if ((yCoordsRaquetRight + 42.8) < yCoordsBall && (yCoordsRaquetRight + 51.52) >= yCoordsBall)  {
						 //          		// alert('51.5');
							//           	clearInterval(endInterval);
							// 	v.play();	
							//           	sendBallLeft(1,1.7);
						 //          	}
						 //          	if ((yCoordsRaquetRight + 51.52) < yCoordsBall && (yCoordsRaquetRight + 63) >= yCoordsBall)  {
						 //          		// alert('60');
							//           	clearInterval(endInterval);
							// 	v.play();	
							//           	sendBallLeft(.9,2);
							// }
							 // if (yCoordsRaquetRight <= yCoordsBall && (yCoordsRaquetRight + 90) >= yCoordsBall)  {
	       //  					          // if (yCoordsRaquetRight >= 277.5 && yCoordsRaquetRight <= 337.5) {      		
							 //          	clearInterval(endInterval);
								// v.play();
							 //          	sendBallLeft();
						  //         	}
					          }
					}
				          else {
				          	drawBall(context, xCoordsBall, yCoordsBall);
				          	clearInterval(endInterval);
			                  }
			          }, 3);
								          	// initGame();
		  	}

			// function clearBall(context) {

			//           context.beginPath();
			//           context.arc(xCoordsBall, yCoordsBall, radius+4, 0, 2 * Math.PI, false);
			//           context.fillStyle = 'rgb(0,0,0)';
			//           context.fill();
			//           return;
			// }

			// function drawBall(context, xCoordsBall, yCoordsBall) {
			//           // console.log(xCoordsBall);
			//            context.beginPath();
			//            context.arc(xCoordsBall, yCoordsBall, radius, 0, 2 * Math.PI, false);
			//            context.fillStyle = 'rgb(255,255,255)';
			//            context.fill();
			//            return;
			//  }

 			function Ball(context, canvas) {

				var self = this;
				var _context;
				var _canvas; 
				var _xCoordsBall; 
				var _yCoordsBall;
				var direction = 'left'; 

				this.drawInitialBall = function(context, canvas, xCoordsBall, yCoordsBall) {

					_context = context;
					_canvas = canvas;
					_xCoordsBall = xCoordsBall;
					_yCoordsBall = yCoordsBall;
				 
				          self.drawBall();
				}

				this.drawBall = function () {
				           _context.beginPath();
				           _context.arc(_xCoordsBall, _yCoordsBall, radius, 0, 2 * Math.PI, false);
				           _context.fillStyle = 'rgb(255,255,255)';
				           _context.fill();
				           return;
				}

	 			this.clearBall = function () {
				           _context.beginPath();
				           _context.arc(_xCoordsBall, _yCoordsBall, radius + 4, 0, 2 * Math.PI, false);
				           _context.fillStyle = 'rgb(0,0,0)';
				           _context.fill();
				           return;
			           }

           				this.moveBall = function(angleX, angleY, leftRaquet, rightRaquet) {
           					
					var endInterval = setInterval(function(){
						self.clearBall();
					          //Bounce ball off top of Canvas by making angle of Y axis positive
						if (_yCoordsBall < 0 && direction == 'right') { 
							angleY = Math.abs(angleY);
						}
						//Bounce ball off bottom of Canvas by making angle of Y axis negative
						if (_yCoordsBall > _canvas.height && direction == 'right') { 
							angleY = -Math.abs(angleY);
						}
						if (_yCoordsBall < 0 && direction == 'left') { 
							angleY = -Math.abs(angleY);
						}
						//Bounce ball off bottom of Canvas by making angle of Y axis negative
						if (_yCoordsBall > _canvas.height && direction == 'left') { 
							angleY = Math.abs(angleY);
						}
							//send left
					          if(direction == 'left') {
						          _xCoordsBall = _xCoordsBall - angleX;
							_yCoordsBall = _yCoordsBall - angleY;
							console.log(angleY);
						          	if (_xCoordsBall >= 45) {
								          self.drawBall();
		          					          if (_xCoordsBall == 126){
		          					          	console.log(leftRaquet.yCoords());
				        					          if (leftRaquet.yCoords() <= _yCoordsBall - 3 && (leftRaquet.yCoords() + 8.57) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(2,-.35, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 8.57) < _yCoordsBall && (leftRaquet.yCoords() + 17.14) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(2,-.5, leftRaquet, rightRaquet);
								          	}
					        					if ((leftRaquet.yCoords() + 17.14) < _yCoordsBall && (leftRaquet.yCoords() + 25.71) >= _yCoordsBall) {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(2,-.75, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 25.71) < _yCoordsBall && (leftRaquet.yCoords() + 34.28) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(1,.9, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 34.28) < _yCoordsBall && (leftRaquet.yCoords() + 42.8) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(1,1.3, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 42.8) < _yCoordsBall && (leftRaquet.yCoords() + 51.52) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(1,1.7, leftRaquet, rightRaquet);
								          	}
								          	if ((leftRaquet.yCoords() + 51.52) < _yCoordsBall && (leftRaquet.yCoords() + 63) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'right';	
									          	self.moveBall(.9,2, leftRaquet, rightRaquet);
								          	}
								          }
						          }
						}
						if(direction == 'right') {
							self.drawBall();
						       	_xCoordsBall = _xCoordsBall + angleX;
							_yCoordsBall = _yCoordsBall + angleY;
							// alert(rightRaquet.yCoords());
						          	if (_xCoordsBall <=(canvas.width-45)) {
						          		self.drawBall();
						          		// console.log(_xCoordsBall);
							           if (_xCoordsBall >= 1348 && _xCoordsBall <= 1349){

							          if (rightRaquet.yCoords() <= (_yCoordsBall - 3) && (rightRaquet.yCoords() + 8.57) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(2,-.35, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 8.57) < _yCoordsBall && (rightRaquet.yCoords() + 17.14) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(2,-.5, leftRaquet, rightRaquet);
								          	}
										if ((rightRaquet.yCoords() + 17.14) < _yCoordsBall && (rightRaquet.yCoords() + 25.71) >= _yCoordsBall) {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(2,-.75, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 25.71) < _yCoordsBall && (rightRaquet.yCoords() + 34.28) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(1,.9, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 34.28) < _yCoordsBall && (rightRaquet.yCoords() + 42.8) >=_yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(1,1.3, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 42.8) < _yCoordsBall && (rightRaquet.yCoords() + 51.52) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(1,1.7, leftRaquet, rightRaquet);
								          	}
								          	if ((rightRaquet.yCoords() + 51.52) < _yCoordsBall && (rightRaquet.yCoords() + 63) >= _yCoordsBall)  {
									          	clearInterval(endInterval);
											v.play();
											direction = 'left';	
									          	self.moveBall(.9,2, leftRaquet, rightRaquet);
								          	}
							          }
						          }
						          else {
						          self.drawBall(context, xCoordsBall, yCoordsBall);
						          clearInterval(endInterval);
						          }
					      	}

					}, 3);

				}
			}

			function Raquet(context, canvas) {

				var self = this;
				var _context;
				var _canvas;
				var _xCoordsRaquet;
				var _yCoordsRaquet;

				this.yCoords = function(){
					return _yCoordsRaquet;
				}
				this.xCoords = function(){
					return _xCoordsRaquet;
				}

				this.drawInitialRaquet = function(context, canvas, xCoordsRaquet, yCoordsRaquet) {

					_context = context;
					_canvas = canvas;
					_xCoordsRaquet = xCoordsRaquet;
					_yCoordsRaquet = yCoordsRaquet;
				 
				          self.drawRaquet(); 
				}

				this.drawRaquet = function() {
					// alert(_yCoordsRaquet);
				          context.beginPath();
				          context.rect(_xCoordsRaquet, _yCoordsRaquet, 10, 60);
				          context.fillStyle = 'rgb(255,255,255)';
				          context.fill();
				          return;
				}

	      			this.clearRaquet = function() {
	      				// alert(context);
					context.clearRect(_xCoordsRaquet-2, _yCoordsRaquet-4, 11, 60);
				           context.beginPath();
				           context.rect(_xCoordsRaquet-2, _yCoordsRaquet-4, 15, 66);
				           context.fillStyle = 'rgb(0,0,0)';
				           context.fill();
				           return;
				}

				this.moveRaquet = function(direction) {
					if (_yCoordsRaquet >= -1 && direction == 'up' ) {
						self.clearRaquet();
				            	_yCoordsRaquet -= 10;
				            	self.drawRaquet();
					}
					if ((_yCoordsRaquet+60) <= _canvas.height && direction == 'down' ) {
						self.clearRaquet();
				            	_yCoordsRaquet += 10;
				            	self.drawRaquet();
				          }
				}
			}

		</script>
	</body>
</html>